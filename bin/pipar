require 'bundler/setup'
Bundler.setup
require 'pipar'
require 'configuration'

Configuration.load ARGV[0]

config = Configuration.for('pipar')
data = File.new config.data_file
parties = if File.exists? config.data_file and data.size > 0
            JSON.load(data)
          else
            []
          end
pipar = config.registry.new
pipar.start parties
JSON.dump parties, File.new(config.data_file, 'w+')